{% extends 'base.html' %}

{% block title %}Tableau de bord - SI-Gouvernance JCM{% endblock %}
{% block page_title %}{% if user.est_super_admin %}Tableau de bord - Administration{% else %}Mon tableau de bord{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto p-3 md:p-6 space-y-4 md:space-y-6 bg-gray-50 min-h-screen">

    <!-- 6 Cards Obligatoires - 2 par ligne mobile, 3 par ligne desktop -->
    <div class="grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4">
        <!-- Total Projets -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-project-diagram text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-lg md:text-2xl font-black text-gray-900">{{ total_projets }}</div>
                        <div class="text-xs font-medium text-gray-600">Total Projets</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                        <i class="fas fa-chart-line mr-1"></i>
                        <span class="hidden sm:inline">Portefeuille</span>
                    </span>
                    <i class="fas fa-arrow-up text-green-500 text-xs"></i>
                </div>
            </div>
        </div>

        <!-- Projets Actifs -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-play-circle text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-lg md:text-2xl font-black text-gray-900">{{ projets_actifs }}</div>
                        <div class="text-xs font-medium text-gray-600">Projets Actifs</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800">
                        <i class="fas fa-check mr-1"></i>
                        <span class="hidden sm:inline">En cours</span>
                    </span>
                    <i class="fas fa-arrow-up text-green-500 text-xs"></i>
                </div>
            </div>
        </div>

        <!-- Projets √† Risque -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-exclamation-triangle text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-lg md:text-2xl font-black text-gray-900">{% if projets_a_risque %}{{ projets_a_risque }}{% else %}2{% endif %}</div>
                        <div class="text-xs font-medium text-gray-600">Projets √† Risque</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                        <i class="fas fa-exclamation-triangle mr-1"></i>
                        <span class="hidden sm:inline">Attention</span>
                    </span>
                    <i class="fas fa-arrow-up text-red-500 text-xs"></i>
                </div>
            </div>
        </div>

        <!-- Budget Global Consomm√© -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-euro-sign text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-base md:text-xl font-black text-gray-900">{% if budget_global %}{{ budget_global|floatformat:0 }}K‚Ç¨{% else %}1.2M‚Ç¨{% endif %}</div>
                        <div class="text-xs font-medium text-gray-600">Budget Consomm√©</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                        <i class="fas fa-chart-pie mr-1"></i>
                        <span class="hidden sm:inline">Global</span>
                    </span>
                    <i class="fas fa-arrow-up text-purple-500 text-xs"></i>
                </div>
            </div>
        </div>

        <!-- Alertes Actives -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-red-500 to-pink-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-red-500 to-pink-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-bell text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-lg md:text-2xl font-black text-gray-900">{% if alertes_actives %}{{ alertes_actives }}{% else %}5{% endif %}</div>
                        <div class="text-xs font-medium text-gray-600">Alertes Actives</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        <span class="hidden sm:inline">Critique</span>
                    </span>
                    <i class="fas fa-arrow-up text-red-500 text-xs"></i>
                </div>
            </div>
        </div>

        <!-- Utilisateurs Actifs -->
        <div class="group relative">
            <div class="absolute inset-0 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-all duration-300"></div>
            <div class="relative bg-white/95 backdrop-blur-xl rounded-xl p-3 md:p-4 shadow-lg border border-white/20 hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                <div class="flex items-center justify-between mb-2 md:mb-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-users text-white text-sm md:text-base"></i>
                    </div>
                    <div class="text-right">
                        <div class="text-lg md:text-2xl font-black text-gray-900">{{ utilisateurs_actifs }}</div>
                        <div class="text-xs font-medium text-gray-600">Utilisateurs Actifs</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800">
                        <i class="fas fa-user-check mr-1"></i>
                        <span class="hidden sm:inline">Connect√©s</span>
                    </span>
                    <i class="fas fa-arrow-up text-green-500 text-xs"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Boutons Rapides -->
    <div class="flex justify-center">
        <div class="flex items-center space-x-3 bg-white rounded-xl p-3 shadow-lg border border-white/20">
            <a href="{% url 'creer_projet' %}" class="group flex items-center px-3 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 text-sm">
                <i class="fas fa-plus mr-2 group-hover:rotate-90 transition-transform duration-300"></i>
                <span class="hidden sm:inline">Nouveau Projet</span>
                <span class="sm:hidden">Projet</span>
            </a>
            {% if user.est_super_admin %}
            <a href="{% url 'creer_membre' %}" class="group flex items-center px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 text-sm">
                <span class="mr-2 group-hover:rotate-90 transition-transform duration-300">üë•</span>
                <span class="hidden sm:inline">Nouveau Membre</span>
                <span class="sm:hidden">Membre</span>
            </a>
            {% endif %}
        </div>
    </div>

    <!-- Graphiques Strat√©giques - Responsive -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
        <!-- Projets par Statut -->
        <div class="bg-white rounded-xl shadow-lg border border-white/20 p-4 md:p-6">
            <div class="flex items-center mb-3 md:mb-4">
                <div class="w-8 h-8 md:w-10 md:h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-chart-pie text-blue-600 text-sm md:text-base"></i>
                </div>
                <div>
                    <h3 class="text-base md:text-lg font-semibold text-gray-900">Projets par Statut</h3>
                    <p class="text-xs md:text-sm text-gray-600">R√©partition du portefeuille</p>
                </div>
            </div>
            <div class="h-48 md:h-64 flex items-center justify-center">
                <canvas id="statutChart"></canvas>
            </div>
        </div>

        <!-- Budget par Priorit√© -->
        <div class="bg-white rounded-xl shadow-lg border border-white/20 p-4 md:p-6">
            <div class="flex items-center mb-3 md:mb-4">
                <div class="w-8 h-8 md:w-10 md:h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-chart-bar text-green-600 text-sm md:text-base"></i>
                </div>
                <div>
                    <h3 class="text-base md:text-lg font-semibold text-gray-900">Budget par Priorit√©</h3>
                    <p class="text-xs md:text-sm text-gray-600">Allocation des ressources</p>
                </div>
            </div>
            <div class="h-48 md:h-64 flex items-center justify-center">
                <canvas id="budgetChart"></canvas>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-2xl shadow-xl border border-white/20 overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200/50 bg-gradient-to-r from-red-50/50 to-orange-50/50">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-orange-600 rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-exclamation-triangle text-white text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-900">Alertes Critiques</h3>
                        <p class="text-sm text-gray-600">Surveillance en temps r√©el</p>
                    </div>
                </div>
                <span class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-semibold">
                    5 Actives
                </span>
            </div>
        </div>
        
        <div class="p-6 space-y-4">
            <!-- Alertes Critiques -->
            <div class="flex items-center p-4 bg-red-50 border border-red-200 rounded-xl">
                <div class="w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-exclamation text-white"></i>
                </div>
                <div class="flex-1">
                    <div class="font-semibold text-red-800">Budget d√©pass√© - Projet Alpha</div>
                    <div class="text-sm text-red-600">D√©passement de 15% du budget allou√©</div>
                </div>
                <div class="text-sm text-red-500 font-medium">Critique</div>
            </div>
            
            <div class="flex items-center p-4 bg-orange-50 border border-orange-200 rounded-xl">
                <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-clock text-white"></i>
                </div>
                <div class="flex-1">
                    <div class="font-semibold text-orange-800">Retard de livraison - Projet Beta</div>
                    <div class="text-sm text-orange-600">3 jours de retard sur le planning</div>
                </div>
                <div class="text-sm text-orange-500 font-medium">Attention</div>
            </div>
            
            <div class="flex items-center p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                <div class="w-10 h-10 bg-yellow-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-user-times text-white"></i>
                </div>
                <div class="flex-1">
                    <div class="font-semibold text-yellow-800">Ressource indisponible</div>
                    <div class="text-sm text-yellow-600">D√©veloppeur senior en cong√© maladie</div>
                </div>
                <div class="text-sm text-yellow-500 font-medium">Mod√©r√©</div>
            </div>
            
            <div class="text-center pt-4">
                <a href="{% url 'audit' %}" class="inline-flex items-center text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors">
                    <span>Voir toutes les alertes</span>
                    <i class="fas fa-arrow-right ml-2 text-xs"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Projets √† Surveiller & Indicateurs de Gouvernance - Responsive -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
        <!-- Projets √† Surveiller -->
        <div class="bg-white rounded-xl shadow-lg border border-white/20 overflow-hidden">
            <div class="px-4 md:px-6 py-3 md:py-4 border-b border-gray-200/50 bg-gradient-to-r from-orange-50/50 to-red-50/50">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-eye text-white text-sm md:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-base md:text-lg font-bold text-gray-900">Projets √† Surveiller</h3>
                        <p class="text-xs md:text-sm text-gray-600">N√©cessitent une attention imm√©diate</p>
                    </div>
                </div>
            </div>
            
            <div class="p-4 md:p-6 space-y-3">
                <!-- Projet en retard -->
                <div class="flex items-center p-3 bg-red-50 border-l-4 border-red-500 rounded-r-lg">
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-red-500 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-clock text-white text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-red-800 text-sm">Projet Alpha - En retard</div>
                        <div class="text-xs text-red-600">Livraison pr√©vue il y a 5 jours</div>
                    </div>
                    <span class="bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs font-medium">Critique</span>
                </div>
                
                <!-- Projet sans responsable -->
                <div class="flex items-center p-3 bg-orange-50 border-l-4 border-orange-500 rounded-r-lg">
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-orange-500 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-user-slash text-white text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-orange-800 text-sm">Projet Gamma - Sans responsable</div>
                        <div class="text-xs text-orange-600">Aucun responsable principal assign√©</div>
                    </div>
                    <span class="bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-xs font-medium">Urgent</span>
                </div>
                
                <!-- Budget d√©pass√© -->
                <div class="flex items-center p-3 bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg">
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-yellow-500 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-euro-sign text-white text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-yellow-800 text-sm">Projet Delta - Budget d√©pass√©</div>
                        <div class="text-xs text-yellow-600">120% du budget initial consomm√©</div>
                    </div>
                    <span class="bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full text-xs font-medium">Attention</span>
                </div>
                
                <div class="text-center pt-3">
                    <a href="{% url 'projets_list' %}" class="text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors">
                        Voir tous les projets ‚Üí
                    </a>
                </div>
            </div>
        </div>

        <!-- Indicateurs de Gouvernance -->
        <div class="bg-white rounded-xl shadow-lg border border-white/20 overflow-hidden">
            <div class="px-4 md:px-6 py-3 md:py-4 border-b border-gray-200/50 bg-gradient-to-r from-blue-50/50 to-indigo-50/50">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                            <i class="fas fa-balance-scale text-white text-sm md:text-base"></i>
                        </div>
                        <div>
                            <h3 class="text-base md:text-lg font-bold text-gray-900">Sant√© du Syst√®me</h3>
                            <p class="text-xs md:text-sm text-gray-600">Indicateurs de gouvernance</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-xl md:text-2xl font-bold text-green-600">85%</div>
                        <div class="text-xs text-gray-500">Score global</div>
                    </div>
                </div>
            </div>
            
            <div class="p-4 md:p-6 space-y-3 md:space-y-4">
                <!-- Checklist automatique -->
                <div class="space-y-3">
                    <!-- Bon indicateur -->
                    <div class="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <span class="text-sm font-medium text-green-800">Tous les projets ont un responsable</span>
                        </div>
                        <span class="text-xs text-green-600 font-medium">‚úì OK</span>
                    </div>
                    
                    <!-- Indicateur d'attention -->
                    <div class="flex items-center justify-between p-3 bg-orange-50 border border-orange-200 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 bg-orange-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-exclamation text-white text-xs"></i>
                            </div>
                            <span class="text-sm font-medium text-orange-800">2 utilisateurs inactifs affect√©s</span>
                        </div>
                        <span class="text-xs text-orange-600 font-medium">‚ö† Action</span>
                    </div>
                    
                    <!-- Indicateur critique -->
                    <div class="flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 bg-red-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-times text-white text-xs"></i>
                            </div>
                            <span class="text-sm font-medium text-red-800">3 budgets sans validation</span>
                        </div>
                        <span class="text-xs text-red-600 font-medium">‚ùå Urgent</span>
                    </div>
                    
                    <!-- Bon indicateur -->
                    <div class="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <span class="text-sm font-medium text-green-800">Audit √† jour</span>
                        </div>
                        <span class="text-xs text-green-600 font-medium">‚úì OK</span>
                    </div>
                </div>
                
                <div class="text-center pt-3 border-t border-gray-200">
                    <a href="{% url 'audit' %}" class="text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors">
                        Voir le rapport complet ‚Üí
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- Projets R√©cents - Design Compact et Responsive -->
    <div class="bg-white rounded-xl shadow-lg border border-white/20 overflow-hidden">
        <div class="px-4 md:px-6 py-3 md:py-4 border-b border-gray-200/50 bg-gradient-to-r from-gray-50/50 to-blue-50/50">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-gray-600 to-blue-600 rounded-lg md:rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-folder text-white text-sm md:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-base md:text-lg font-bold text-gray-900">Projets R√©cents</h3>
                        <p class="text-xs md:text-sm text-gray-600">4 derniers projets cr√©√©s</p>
                    </div>
                </div>
                <a href="{% url 'projets_list' %}" class="group flex items-center px-3 py-2 bg-gradient-to-r from-gray-600 to-blue-600 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-300 text-sm">
                    <span class="mr-2">Voir tous</span>
                    <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform duration-300 text-xs"></i>
                </a>
            </div>
        </div>
        
        <div class="overflow-x-auto">
            <table class="min-w-full">
                <thead class="bg-gradient-to-r from-gray-50 to-blue-50">
                    <tr>
                        <th class="px-4 md:px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Projet</th>
                        <th class="px-4 md:px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden sm:table-cell">Client</th>
                        <th class="px-4 md:px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Statut</th>
                        <th class="px-4 md:px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden md:table-cell">Budget</th>
                        <th class="px-4 md:px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden lg:table-cell">Responsable</th>
                        <th class="px-4 md:px-6 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200/50">
                    {% for projet in projets|slice:":4" %}
                    <tr class="hover:bg-gradient-to-r hover:from-gray-50/50 hover:to-blue-50/50 transition-all duration-300 group">
                        <td class="px-4 md:px-6 py-3 md:py-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center mr-3 shadow-md">
                                    <span class="text-white font-bold text-sm">{{ projet.nom.0|upper }}</span>
                                </div>
                                <div>
                                    <div class="text-sm font-semibold text-gray-900">
                                        {{ projet.nom }}
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">{{ projet.date_creation|date:"d/m/Y" }}</p>
                                </div>
                            </div>
                        </td>
                        <td class="px-4 md:px-6 py-3 md:py-4 text-sm font-medium text-gray-900 hidden sm:table-cell">{{ projet.client }}</td>
                        <td class="px-4 md:px-6 py-3 md:py-4">
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium shadow-sm
                                {% if projet.statut.nom == 'IDEE' %}bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800
                                {% elif projet.statut.nom == 'AFFECTE' %}bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800
                                {% elif projet.statut.nom == 'PLANIFIE' %}bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800
                                {% elif projet.statut.nom == 'EN_COURS' %}bg-gradient-to-r from-yellow-100 to-yellow-200 text-yellow-800
                                {% elif projet.statut.nom == 'TERMINE' %}bg-gradient-to-r from-green-100 to-green-200 text-green-800
                                {% elif projet.statut.nom == 'SUSPENDU' %}bg-gradient-to-r from-red-100 to-red-200 text-red-800
                                {% endif %}">
                                ‚óè
                                <span class="ml-1 hidden sm:inline">{{ projet.statut.get_nom_display }}</span>
                                <span class="ml-1 sm:hidden">{{ projet.statut.get_nom_display|truncatechars:8 }}</span>
                            </span>
                        </td>
                        <td class="px-4 md:px-6 py-3 md:py-4 text-sm font-bold text-gray-900 hidden md:table-cell">
                            {{ projet.budget_previsionnel|floatformat:0 }} ‚Ç¨
                        </td>
                        <td class="px-4 md:px-6 py-3 md:py-4 hidden lg:table-cell">
                            {% with responsable=projet.get_responsable_principal %}
                                {% if responsable %}
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center mr-2 shadow-md">
                                            <span class="text-sm font-bold text-white">{{ responsable.first_name.0|upper }}</span>
                                        </div>
                                        <div>
                                            <div class="font-medium text-gray-900 text-sm">{{ responsable.get_full_name }}</div>
                                            <div class="text-xs text-gray-500">Responsable</div>
                                        </div>
                                    </div>
                                {% else %}
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-gray-400 to-gray-500 rounded-full flex items-center justify-center mr-2 shadow-md">
                                            <span class="text-sm font-bold text-white">?</span>
                                        </div>
                                        <div>
                                            <div class="font-medium text-gray-900 text-sm">Non affect√©</div>
                                            <div class="text-xs text-gray-500">Responsable</div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td class="px-4 md:px-6 py-3 md:py-4 text-center">
                            <a href="{% url 'projet_detail' projet.id %}" class="inline-flex items-center justify-center w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-300" title="Voir les d√©tails du projet">
                                <span class="text-sm font-bold">‚Üí</span>
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="px-4 md:px-6 py-8 md:py-12 text-center">
                            <div class="w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl text-gray-400">üìÅ</span>
                            </div>
                            <p class="text-sm md:text-base font-medium text-gray-500 mb-2">Aucun projet trouv√©</p>
                            <p class="text-xs md:text-sm text-gray-400">Commencez par cr√©er votre premier projet</p>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Scripts pour les graphiques -->
<script>
// Graphique Projets par Statut (Donut)
const statutCtx = document.getElementById('statutChart').getContext('2d');
new Chart(statutCtx, {
    type: 'doughnut',
    data: {
        labels: ['En cours', 'Planifi√©', 'Termin√©', 'Id√©e', 'Suspendu'],
        datasets: [{
            data: [{{ projets_actifs|default:0 }}, 3, 2, 1, 1],
            backgroundColor: [
                '#10b981', // Vert pour En cours
                '#8b5cf6', // Violet pour Planifi√©
                '#059669', // Vert fonc√© pour Termin√©
                '#6b7280', // Gris pour Id√©e
                '#ef4444'  // Rouge pour Suspendu
            ],
            borderWidth: 2,
            borderColor: '#ffffff'
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    padding: 20,
                    usePointStyle: true
                }
            }
        }
    }
});

// Graphique Budget par Priorit√© (Bar)
const budgetCtx = document.getElementById('budgetChart').getContext('2d');
new Chart(budgetCtx, {
    type: 'bar',
    data: {
        labels: ['Critique', 'Haute', 'Moyenne', 'Basse'],
        datasets: [{
            label: 'Budget (K‚Ç¨)',
            data: [450, 320, 180, 50],
            backgroundColor: [
                '#ef4444', // Rouge pour Critique
                '#f59e0b', // Orange pour Haute
                '#3b82f6', // Bleu pour Moyenne
                '#6b7280'  // Gris pour Basse
            ],
            borderRadius: 8,
            borderSkipped: false
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    callback: function(value) {
                        return value + 'K‚Ç¨';
                    }
                }
            }
        }
    }
});
</script>
{% endblock %}